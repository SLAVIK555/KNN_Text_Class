Домашнее задание №1 по курсу "Введение в ИИ"

Задача: Разработать текстовый классификатор с применением метода K ближайших соседей


Update(Я добавил юпитер, там все более наглядно и в одном файле, то, что в PS больше не актуально)


Файл word_freq_counter.py содержит функционал для подсчета частоты встречи слов в исходном датасете, чтобы определить наиболее часто встречающиеся слова, которые войдут в вектор для дальнейшей классификации. При этом при подстчете слов используется так называемый стоплист - список слов для русского языка, которые довольно часто встречаются в разговорной речи и письме, но при этом не несут никакой смысловой нагрузки, а следовательно не могут быть маркерами для текстов определенного класса. Примеры таких слов приведены в файле stopwords.txt. Эти слова в общем подсчете не участвуют.

После того, как мы определили наиболее часто встречающиеся слова для классов Детектив и Космическая фантастика (файлы Detective.txt и Space_fiction.txt), нам предстоит на наше усмотрение выбрать те слова, которые встречаются достаточно часто и по нашему мнению отлично характеризуют данный класс текстов, после чего внести эти слова в наш вектор (файл Vector.txt), а после чего удалить повторяющиеся слова (файл NewVector.txt)

Далее перейдем к составлению датасета для в виде массива для нашего классификатора

Файл dataset_maker.py содержит функционал для составления датасета в виде набора векторов из исходного набора текстов. При этом каждому тексту сопоставляется вектор, который содержит частоты появления каждого из слов, находящихся в нашем контрольном списке слов (файл NewVector.txt)

Файл predictor.py содержит функционал для классификации нового текста на основе составленного датасета. При классификации нового текста данный текст прогоняется черех фит-функцию (для него находится вектор частот появления контрольных слов как при составлении датасета из исходных текстов), после чего рассчитывается евклидово расстояние между вектором нового текста и всеми векторами всех текстов, представленных в датасете. Затем определяется принадлежность к классам K ближайших векторов. Класс нового вектора считается равным классу тех векторов, которых больше в выборке из K ближайших векторов

Вывод программы:
0 is Detective, 1 is Space Fiction
----------------------------------
Test text is D1
Expected 0, Got 0, K 3, List [0.0, 0.0, 0.0]
----------------------------------------------------
Expected 0, Got 0, K 5, List [0.0, 0.0, 0.0, 0.0, 1.0]
----------------------------------------------------
Expected 0, Got 0, K 7, List [0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0]
----------------------------------------------------
Expected 0, Got 0, K 9, List [0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0]
----------------------------------------------------
----------------------------------------------------
----------------------------------------------------
Test text is D2
Expected 0, Got 0, K 3, List [0.0, 0.0, 0.0]
----------------------------------------------------
Expected 0, Got 0, K 5, List [0.0, 0.0, 0.0, 0.0, 0.0]
----------------------------------------------------
Expected 0, Got 0, K 7, List [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]
----------------------------------------------------
Expected 0, Got 0, K 9, List [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0]
----------------------------------------------------
----------------------------------------------------
----------------------------------------------------
Test text is S1
Expected 1, Got 1, K 3, List [1.0, 1.0, 0.0]
----------------------------------------------------
Expected 1, Got 0, K 5, List [1.0, 1.0, 0.0, 0.0, 0.0]
----------------------------------------------------
Expected 1, Got 1, K 7, List [1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0]
----------------------------------------------------
Expected 1, Got 1, K 9, List [1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0]
----------------------------------------------------
----------------------------------------------------
----------------------------------------------------
Test text is S2
Expected 1, Got 1, K 3, List [0.0, 1.0, 1.0]
----------------------------------------------------
Expected 1, Got 1, K 5, List [0.0, 1.0, 1.0, 1.0, 0.0]
----------------------------------------------------
Expected 1, Got 1, K 7, List [0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0]
----------------------------------------------------
Expected 1, Got 1, K 9, List [0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0]
----------------------------------------------------
----------------------------------------------------
----------------------------------------------------

Расшифруем вывод:
В первой строке дается обозначение каждого из классов в цифровом виде.
Далее расшифруем вывод на примере одной из строки, в частности:
Expected 0, Got 0, K 5, List [0.0, 0.0, 0.0, 0.0, 1.0]

Expected 0 - ожидалось получить на вход текст из класса 0
Got 0 - текст классифицирован как текст класса 0
K 5 - текст классифицировали по 5 ближайшим соседям
List [0.0, 0.0, 0.0, 0.0, 1.0] - Список ближайших соседей, среди ближайших соседей 4 текста класса 0 и 1 текст класса 1


Еще одна строка:
Expected 1, Got 0, K 5, List [1.0, 1.0, 0.0, 0.0, 0.0]

Expected 1 - ожидалось получить на вход текст из класса 1
Got 0 - текст классифицирован как текст класса 0, мы потерпели неудачу :(
K 5 - текст классифицировали по 5 ближайшим соседям
List [1.0, 1.0, 0.0, 0.0, 0.0] - Список ближайших соседей, среди ближайших соседей 3 текста класса 0 и 2 текст класса 1

PS: Это еще не окончательный вариант кода, я еще буду приводить его в цивильный вид

PPS: По всем вопросам пишите мне на почту: slavabogomoloff@yandex.ru